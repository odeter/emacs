#!/bin/bash
# A simple script

args=("$@")

if [ "$1" == "-h" ]; then
    echo "$package - Search for alarms to raise"
    echo " "
    echo "$package date_start date_end"
    exit 1
elif [ "$1" == '--local' ]; then
    source venv/bin/activate
    flock -n -x auto_iplookup.py -c "python3 auto_iplookup.py"
    # if [ -f "auto_iplookup.log" ]; then
    #     var1=$(tac auto_iplookup.log | grep -m1 INFO | sed -e 's/\(^.*|\)\(.*\)\(|.*$\)/\2/')
    #     python3 auto_iplookup.py "$var1"
    # else
    #     echo "does not exists"
    #     python3 auto_iplookup.py
    # fi
else
    flock -n -x cron_jobs/auto_iplookup/auto_iplookup.py -c "python3 cron_jobs/auto_iplookup/auto_iplookup.py"
    # export URL="https://deer.derant.com/apicall"
    # export EXPORT=`dokku postgres:info angle_db --exposed-ports | sed 's/[0-9]*->//g' | sed 's/[[:space:]]//g'`
    # export DATABASE_URL=`dokku postgres:info angle_db --dsn | sed "s/@[a-z -]*:['0-9']*/@localhost:$EXPORT/g"`
    # echo "Running not local is only with the python script"
fi
