(undo-tree-save-format-version . 1)
"6043c6d73e22ecd001ff2ce1172753fdb56fb644"
[nil nil nil nil (25479 8940 714748 535000) 0 nil]
([nil nil ((#("    @role_required([\"admin\", \"mssp_it_sec\", \"mssp_admin\"])
    def post(self):
        parserK = reqparse.RequestParser()
        parserK.add_argument('userid', help = 'This field cannot be blank', required = True)
        parserK.add_argument('roles', help = 'This field cannot be blank', required = True)
        parserK.add_argument('active', help = 'This field cannot be blank', required = True)
        parserK.add_argument('notify_user', help = 'This field cannot be blank', required = True)
        data = parserK.parse_args()


        userID = get_jwt_identity()
        current_user = UserModel.find_by_id(userID)
        roles = json.loads(data[\"roles\"])
        edit_user = UserModel.find_by_id(data['userid'])
        if current_user and edit_user:
            if edit_user.parent_id == current_user.id:
                edit_user.active = json.loads(data['active'])
                edit_user.notify_user = json.loads(data['notify_user'])
                if not roles:
                    return {'message': 'error_41'}, 500
                t_list = [d.id for d in current_user.get_createable_roles()]
                for i in roles:
                    if i not in t_list:
                        app.logger.error('{0} - {1} tried editing user {2} - {3}, but had no permissions to grant the selected role'.format(current_user.name, current_user.id, edit_user.name, edit_user.id))
                        return {'message': 'error_42'}, 500
                edit_user.append_roles_reset(roles)
                try:
                    edit_user.save_to_db()
                    app.logger.info('{0} - {1} edited user {2} - {3}'.format(current_user.name, current_user.id, edit_user.name, edit_user.id))
                    return {'message': 'User was edited'}, 200
                except:
                    app.logger.error('{0} - {1} tried editing user {2} - {3}, but could not save to db'.format(current_user.name, current_user.id, edit_user.name, edit_user.id))
                    return {'message': 'Something went wrong internally'}, 500
            else:
                app.logger.error('{0} - {1} tried editing user {2} - {3}, but user is not the right child'.format(current_user.name, current_user.id, edit_user.name, edit_user.id))
                return {'message': 'User is not the right child'}, 403

        else:
            app.logger.error('user with ID: {0} tried editing a user, without permissions'.format(userID))
            return {'message': 'User not set properly'}, 403" 0 4 (fontified t) 4 18 (fontified t face font-lock-type-face) 18 19 (fontified t face (rainbow-delimiters-depth-1-face)) 19 20 (fontified t face (rainbow-delimiters-depth-2-face)) 20 27 (fontified t face font-lock-string-face) 27 29 (fontified t) 29 42 (fontified t face font-lock-string-face) 42 44 (fontified t) 44 56 (fontified t face font-lock-string-face) 56 57 (fontified t face (rainbow-delimiters-depth-2-face)) 57 58 (fontified t face (rainbow-delimiters-depth-1-face)) 58 63 (fontified t) 63 66 (fontified t face font-lock-keyword-face) 66 67 (fontified t) 67 71 (fontified t face font-lock-function-name-face) 71 72 (fontified t face (rainbow-delimiters-depth-1-face)) 72 76 (fontified t face font-lock-keyword-face) 76 77 (fontified t face (rainbow-delimiters-depth-1-face)) 77 87 (fontified t) 87 94 (fontified t face font-lock-variable-name-face) 94 119 (fontified t) 119 120 (fontified t face (rainbow-delimiters-depth-1-face)) 120 121 (fontified t face (rainbow-delimiters-depth-1-face)) 121 150 (fontified t) 150 151 (fontified t face (rainbow-delimiters-depth-1-face)) 151 159 (fontified t face font-lock-string-face) 159 161 (fontified t) 161 165 (fontified t face font-lock-builtin-face) 165 168 (fontified t) 168 196 (fontified t face font-lock-string-face) 196 209 (fontified t) 209 213 (fontified t face font-lock-constant-face) 213 214 (fontified t face (rainbow-delimiters-depth-1-face)) 214 243 (fontified t) 243 244 (fontified t face (rainbow-delimiters-depth-1-face)) 244 246 (fontified t face font-lock-string-face) 246 251 (fontified t face font-lock-string-face) 251 253 (fontified t) 253 257 (fontified t face font-lock-builtin-face) 257 260 (fontified t) 260 288 (fontified t face font-lock-string-face) 288 301 (fontified t) 301 305 (fontified t face font-lock-constant-face) 305 306 (fontified t face (rainbow-delimiters-depth-1-face)) 306 335 (fontified t) 335 336 (fontified t face (rainbow-delimiters-depth-1-face)) 336 344 (fontified t face font-lock-string-face) 344 346 (fontified t) 346 350 (fontified t face font-lock-builtin-face) 350 353 (fontified t) 353 381 (fontified t face font-lock-string-face) 381 394 (fontified t) 394 398 (fontified t face font-lock-constant-face) 398 399 (fontified t face (rainbow-delimiters-depth-1-face)) 399 428 (fontified t) 428 429 (fontified t face (rainbow-delimiters-depth-1-face)) 429 442 (fontified t face font-lock-string-face) 442 444 (fontified t) 444 448 (fontified t face font-lock-builtin-face) 448 451 (fontified t) 451 479 (fontified t face font-lock-string-face) 479 492 (fontified t) 492 496 (fontified t face font-lock-constant-face) 496 497 (fontified t face (rainbow-delimiters-depth-1-face)) 497 499 (fontified t) 499 506 (fontified t) 506 510 (fontified t face font-lock-variable-name-face) 510 531 (fontified t) 531 532 (fontified t face (rainbow-delimiters-depth-1-face)) 532 533 (fontified t face (rainbow-delimiters-depth-1-face)) 533 534 (fontified t) 534 544 (fontified t) 544 550 (fontified t face font-lock-variable-name-face) 550 569 (fontified t) 569 570 (fontified t face (rainbow-delimiters-depth-1-face)) 570 571 (fontified t face (rainbow-delimiters-depth-1-face)) 571 580 (fontified t) 580 592 (fontified t face font-lock-variable-name-face) 592 615 (fontified t) 615 616 (fontified t face (rainbow-delimiters-depth-1-face)) 616 622 (fontified t) 622 623 (fontified t face (rainbow-delimiters-depth-1-face)) 623 632 (fontified t) 632 637 (fontified t face font-lock-variable-name-face) 637 650 (fontified t) 650 651 (fontified t face (rainbow-delimiters-depth-1-face)) 651 655 (fontified t) 655 656 (fontified t face (rainbow-delimiters-depth-2-face)) 656 663 (fontified t face font-lock-string-face) 663 664 (fontified t face (rainbow-delimiters-depth-2-face)) 664 665 (fontified t face (rainbow-delimiters-depth-1-face)) 665 674 (fontified t) 674 683 (fontified t face font-lock-variable-name-face) 683 706 (fontified t) 706 707 (fontified t face (rainbow-delimiters-depth-1-face)) 707 711 (fontified t) 711 712 (fontified t face (rainbow-delimiters-depth-2-face)) 712 720 (fontified t face font-lock-string-face) 720 721 (fontified t face (rainbow-delimiters-depth-2-face)) 721 722 (fontified t face (rainbow-delimiters-depth-1-face)) 722 731 (fontified t) 731 733 (fontified t face font-lock-keyword-face) 733 746 (fontified t) 746 747 (fontified t) 747 750 (fontified t face font-lock-keyword-face) 750 774 (fontified t) 774 776 (fontified t face font-lock-keyword-face) 776 813 (fontified t) 813 815 (fontified t face font-lock-builtin-face) 815 833 (fontified t) 833 849 (fontified t face font-lock-variable-name-face) 849 862 (fontified t) 862 863 (fontified t face (rainbow-delimiters-depth-1-face)) 863 867 (fontified t) 867 868 (fontified t face (rainbow-delimiters-depth-2-face)) 868 876 (fontified t face font-lock-string-face) 876 877 (fontified t face (rainbow-delimiters-depth-2-face)) 877 878 (fontified t face (rainbow-delimiters-depth-1-face)) 878 895 (fontified t) 895 916 (fontified t face font-lock-variable-name-face) 916 929 (fontified t) 929 930 (fontified t face (rainbow-delimiters-depth-1-face)) 930 934 (fontified t) 934 935 (fontified t face (rainbow-delimiters-depth-2-face)) 935 948 (fontified t face font-lock-string-face) 948 949 (fontified t face (rainbow-delimiters-depth-2-face)) 949 950 (fontified t face (rainbow-delimiters-depth-1-face)) 950 967 (fontified t) 967 969 (fontified t face font-lock-keyword-face) 969 970 (fontified t) 970 973 (fontified t face font-lock-keyword-face) 973 1001 (fontified t) 1001 1007 (fontified t face font-lock-keyword-face) 1007 1008 (fontified t) 1008 1009 (fontified t face (rainbow-delimiters-depth-1-face)) 1009 1018 (fontified t face font-lock-string-face) 1018 1020 (fontified t) 1020 1030 (fontified t face font-lock-string-face) 1030 1031 (fontified t face (rainbow-delimiters-depth-1-face)) 1031 1034 (fontified t) 1034 1037 (fontified t) 1037 1053 (fontified t) 1053 1059 (fontified t face font-lock-variable-name-face) 1059 1062 (fontified t) 1062 1063 (fontified t face (rainbow-delimiters-depth-1-face)) 1063 1065 (fontified t) 1065 1067 (fontified t face font-lock-builtin-face) 1067 1068 (fontified t) 1068 1071 (fontified t face font-lock-keyword-face) 1071 1074 (fontified t) 1074 1076 (fontified t face font-lock-keyword-face) 1076 1110 (fontified t) 1110 1111 (fontified t face (rainbow-delimiters-depth-2-face)) 1111 1112 (fontified t face (rainbow-delimiters-depth-2-face)) 1112 1113 (fontified t face (rainbow-delimiters-depth-1-face)) 1113 1130 (fontified t) 1130 1133 (fontified t face font-lock-keyword-face) 1133 1136 (fontified t) 1136 1138 (fontified t face font-lock-keyword-face) 1138 1166 (fontified t) 1166 1168 (fontified t face font-lock-keyword-face) 1168 1171 (fontified t) 1171 1174 (fontified t face font-lock-keyword-face) 1174 1175 (fontified t) 1175 1177 (fontified t face font-lock-keyword-face) 1177 1226 (fontified t) 1226 1227 (fontified t face (rainbow-delimiters-depth-1-face)) 1227 1318 (fontified t face font-lock-string-face) 1318 1319 (fontified t) 1319 1325 (fontified t face font-lock-builtin-face) 1325 1326 (fontified t face (rainbow-delimiters-depth-2-face)) 1326 1336 (fontified t) 1336 1358 (fontified t face (whitespace-line)) 1358 1360 (fontified t face (whitespace-line font-lock-builtin-face)) 1360 1388 (fontified t face (whitespace-line)) 1388 1390 (fontified t face (whitespace-line font-lock-builtin-face)) 1390 1391 (fontified t face (rainbow-delimiters-depth-2-face whitespace-line)) 1391 1392 (fontified t face (rainbow-delimiters-depth-1-face whitespace-line)) 1392 1417 (fontified t) 1417 1423 (fontified t face font-lock-keyword-face) 1423 1424 (fontified t) 1424 1425 (fontified t face (rainbow-delimiters-depth-1-face)) 1425 1434 (fontified t face font-lock-string-face) 1434 1436 (fontified t) 1436 1446 (fontified t face font-lock-string-face) 1446 1447 (fontified t face (rainbow-delimiters-depth-1-face)) 1447 1497 (fontified t) 1497 1498 (fontified t face (rainbow-delimiters-depth-1-face)) 1498 1503 (fontified t) 1503 1504 (fontified t face (rainbow-delimiters-depth-1-face)) 1504 1521 (fontified t) 1521 1524 (fontified t face font-lock-keyword-face) 1524 1537 (fontified t) 1537 1566 (fontified t) 1566 1567 (fontified t face (rainbow-delimiters-depth-1-face)) 1567 1568 (fontified t face (rainbow-delimiters-depth-1-face)) 1568 1569 (fontified t) 1569 1604 (fontified t) 1604 1605 (fontified t face (rainbow-delimiters-depth-1-face)) 1605 1638 (fontified t face font-lock-string-face) 1638 1639 (fontified t) 1639 1645 (fontified t face font-lock-builtin-face) 1645 1646 (fontified t face (rainbow-delimiters-depth-2-face)) 1646 1678 (fontified t) 1678 1680 (fontified t face font-lock-builtin-face) 1680 1708 (fontified t) 1708 1710 (fontified t face font-lock-builtin-face) 1710 1711 (fontified t face (rainbow-delimiters-depth-2-face)) 1711 1712 (fontified t face (rainbow-delimiters-depth-1-face)) 1712 1733 (fontified t) 1733 1739 (fontified t face font-lock-keyword-face) 1739 1740 (fontified t) 1740 1741 (fontified t face (rainbow-delimiters-depth-1-face)) 1741 1750 (fontified t face font-lock-string-face) 1750 1752 (fontified t) 1752 1769 (fontified t face font-lock-string-face) 1769 1770 (fontified t face (rainbow-delimiters-depth-1-face)) 1770 1792 (fontified t) 1792 1798 (fontified t face font-lock-keyword-face) 1798 1836 (fontified t) 1836 1837 (fontified t face (rainbow-delimiters-depth-1-face)) 1837 1903 (fontified t face font-lock-string-face) 1903 1904 (fontified t) 1904 1910 (fontified t face font-lock-builtin-face) 1910 1911 (fontified t face (rainbow-delimiters-depth-2-face)) 1911 1943 (fontified t) 1943 1945 (fontified t face font-lock-builtin-face) 1945 1950 (fontified t) 1950 1973 (fontified t face (whitespace-line)) 1973 1975 (fontified t face (whitespace-line font-lock-builtin-face)) 1975 1976 (fontified t face (rainbow-delimiters-depth-2-face whitespace-line)) 1976 1977 (fontified t face (rainbow-delimiters-depth-1-face whitespace-line)) 1977 1998 (fontified t) 1998 2004 (fontified t face font-lock-keyword-face) 2004 2005 (fontified t) 2005 2006 (fontified t face (rainbow-delimiters-depth-1-face)) 2006 2015 (fontified t face font-lock-string-face) 2015 2017 (fontified t) 2017 2037 (fontified t face font-lock-string-face) 2037 2050 (fontified t face font-lock-string-face) 2050 2051 (fontified t face (rainbow-delimiters-depth-1-face)) 2051 2069 (fontified t) 2069 2073 (fontified t face font-lock-keyword-face) 2073 2075 (fontified t) 2075 2107 (fontified t) 2107 2108 (fontified t face (rainbow-delimiters-depth-1-face)) 2108 2181 (fontified t face font-lock-string-face) 2181 2182 (fontified t) 2182 2188 (fontified t face font-lock-builtin-face) 2188 2189 (fontified t face (rainbow-delimiters-depth-2-face)) 2189 2221 (fontified t) 2221 2223 (fontified t face font-lock-builtin-face) 2223 2225 (fontified t) 2225 2251 (fontified t face (whitespace-line)) 2251 2253 (fontified t face (whitespace-line font-lock-builtin-face)) 2253 2254 (fontified t face (rainbow-delimiters-depth-2-face whitespace-line)) 2254 2255 (fontified t face (rainbow-delimiters-depth-1-face whitespace-line)) 2255 2272 (fontified t) 2272 2278 (fontified t face font-lock-keyword-face) 2278 2279 (fontified t) 2279 2280 (fontified t face (rainbow-delimiters-depth-1-face)) 2280 2289 (fontified t face font-lock-string-face) 2289 2291 (fontified t) 2291 2320 (fontified t face font-lock-string-face) 2320 2321 (fontified t face (rainbow-delimiters-depth-1-face)) 2321 2336 (fontified t) 2336 2340 (fontified t face font-lock-keyword-face) 2340 2370 (fontified t) 2370 2371 (fontified t face (rainbow-delimiters-depth-1-face)) 2371 2432 (fontified t face font-lock-string-face) 2432 2433 (fontified t) 2433 2439 (fontified t face font-lock-builtin-face) 2439 2440 (fontified t face (rainbow-delimiters-depth-2-face)) 2440 2446 (fontified t) 2446 2447 (fontified t face (rainbow-delimiters-depth-2-face)) 2447 2448 (fontified t face (rainbow-delimiters-depth-1-face)) 2448 2461 (fontified t) 2461 2467 (fontified t face font-lock-keyword-face) 2467 2468 (fontified t) 2468 2469 (fontified t face (rainbow-delimiters-depth-1-face)) 2469 2478 (fontified t face font-lock-string-face) 2478 2480 (fontified t) 2480 2503 (fontified t face font-lock-string-face) 2503 2504 (fontified t face (rainbow-delimiters-depth-1-face)) 2504 2509 (fontified t)) . 2255) (undo-tree-id10 . -2509) (undo-tree-id11 . -59) (undo-tree-id12 . -2509) (undo-tree-id13 . -2509) (t 25430 15053 139608 745000)) nil (25479 8940 714746 145000) 0 nil])
([nil nil ((#("
" 0 1 (fontified t)) . -2253) (undo-tree-id0 . -1) (undo-tree-id1 . -1) (undo-tree-id2 . -1) (undo-tree-id3 . -1) (undo-tree-id4 . -1) (#("
" 0 1 (fontified t)) . -2254) (undo-tree-id5 . -1) (undo-tree-id6 . -1) (undo-tree-id7 . -1) (undo-tree-id8 . -1) (undo-tree-id9 . -1) 2255) nil (25479 8940 714736 82000) 0 nil])
([nil nil ((#("g" 0 1 (fontified t face font-lock-function-name-face)) . -358) (undo-tree-id14 . -1) (undo-tree-id15 . -1) (#("e" 0 1 (fontified t face font-lock-function-name-face)) . -359) (undo-tree-id16 . -1) (undo-tree-id17 . -1) (#("t" 0 1 (fontified t face font-lock-function-name-face)) . -360) (undo-tree-id18 . -1) (undo-tree-id19 . -1) 361 (t 25479 8940 721360 785000)) nil (25479 8944 982217 123000) 0 nil])
([nil current ((358 . 362)) nil (25479 8944 982194 652000) 0 nil])
nil
